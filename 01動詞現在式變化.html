<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>互動式德文講義</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: 採用垂直分區的單頁應用程式結構。1. 核心概念區：靜態介紹基本規則。2. 互動規則區：透過頁籤(Tabs)切換「規則動詞」、「特殊規則」與「不規則動詞」，其中「規則動詞」附有互動式動詞變化產生器，讓使用者能輸入動詞並即時看到變化結果，加深學習印象。3. 互動練習區：將講義的填空題改為可輸入的表單，並提供「檢查答案」功能，給予即時的視覺回饋。此結構引導使用者從「學習」到「探索」再到「測驗」，符合有效的學習路徑，比單純閱讀講義更能提升學習成效。 -->
    <!-- Visualization & Content Choices: 1. 動詞變化規則 -> 目標: 參考與互動 -> 呈現方式: HTML表格搭配JavaScript驅動的「動詞變化產生器」。使用者輸入動詞後，程式會自動應用詞幹+字尾規則，包含對-d/-t/-s等特殊詞幹的判斷，並新增不規則動詞的例外處理，使其結果更準確。 -> 理由: 將被動的規則學習轉化為主動的探索過程。 2. 課後練習 -> 目標: 知識測驗與反饋 -> 呈現方式: HTML段落中嵌入input欄位，透過JS進行答案比對。 -> 互動: 點擊按鈕後，系統會標示出正確(綠色)與錯誤(紅色)的答案，並顯示正確解答。 -> 理由: 即時反饋是語言學習中最有效的工具之一。所有視覺元素均使用HTML/CSS/Tailwind實現。 -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .tab-active {
            border-color: #8E7AB5;
            color: #8E7AB5;
            font-weight: 700;
        }
        .tab-inactive {
            border-color: transparent;
            color: #9B9B9B;
        }
        .feedback-correct {
            background-color: #E6F4EA;
            color: #3C864A;
            border-color: #A3D3B0;
        }
        .feedback-incorrect {
            background-color: #FBE9E9;
            color: #D93025;
            border-color: #F4B9B6;
        }
    </style>
</head>
<body>

    <div class="container mx-auto p-4 md:p-8 max-w-4xl">

        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-[#BCA37F]">互動式德文講義</h1>
            <p class="mt-2 text-lg text-gray-500">動詞現在式變化</p>
        </header>

        <main>
            <!-- Section 1: Core Concept -->
            <section id="concept" class="mb-12 p-6 bg-white rounded-xl shadow-sm">
                <h2 class="text-2xl font-bold mb-4 text-[#8E7AB5]">核心概念：動詞詞幹 + 字尾</h2>
                <p class="mb-4">德文動詞的原型 (不定式) 通常以 <code class="bg-gray-100 text-red-500 px-1 rounded">-en</code> 結尾。進行動詞變化時，我們需要先找到動詞的「詞幹」(Wortstamm)，也就是把 <code class="bg-gray-100 text-red-500 px-1 rounded">-en</code> 去掉後剩下的部分。</p>
                <div class="p-4 bg-blue-50 border-l-4 border-blue-400 text-blue-800 rounded-r-lg">
                    <p>例如： <strong class="font-semibold">machen</strong> (做) → 詞幹為 <strong class="font-semibold">mach-</strong></p>
                    <p>接著，根據不同的主詞，在詞幹後面加上對應的「字尾」(Endungen) 就可以了！</p>
                </div>
            </section>

            <!-- Section 2: Rules -->
            <section id="rules" class="mb-12">
                <h2 class="text-2xl font-bold mb-4 text-center text-[#8E7AB5]">規則與變化</h2>
                
                <div class="flex justify-center border-b mb-6">
                    <button class="tab-btn tab-active py-2 px-6 border-b-2 transition-colors duration-300" onclick="showTab('regular')">規則動詞</button>
                    <button class="tab-btn tab-inactive py-2 px-6 border-b-2 transition-colors duration-300" onclick="showTab('special')">特殊規則</button>
                    <button class="tab-btn tab-inactive py-2 px-6 border-b-2 transition-colors duration-300" onclick="showTab('irregular')">重要不規則動詞</button>
                </div>

                <div id="tab-content" class="p-6 bg-white rounded-xl shadow-sm">
                    <!-- Regular Verbs -->
                    <div id="regular" class="tab-pane">
                        <h3 class="text-xl font-semibold mb-4">主詞與對應字尾</h3>
                        <div class="overflow-x-auto mb-8">
                            <table class="w-full text-left border-collapse">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="p-3 font-semibold text-sm border-b">主詞代名詞</th>
                                        <th class="p-3 font-semibold text-sm border-b">中文意思</th>
                                        <th class="p-3 font-semibold text-sm border-b">字尾變化</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="hover:bg-gray-50"><td class="p-3 border-b">ich</td><td class="p-3 border-b">我</td><td class="p-3 border-b font-mono text-red-600">-e</td></tr>
                                    <tr class="hover:bg-gray-50"><td class="p-3 border-b">du</td><td class="p-3 border-b">你</td><td class="p-3 border-b font-mono text-red-600">-st</td></tr>
                                    <tr class="hover:bg-gray-50"><td class="p-3 border-b">er/sie/es</td><td class="p-3 border-b">他/她/它</td><td class="p-3 border-b font-mono text-red-600">-t</td></tr>
                                    <tr class="hover:bg-gray-50"><td class="p-3 border-b">wir</td><td class="p-3 border-b">我們</td><td class="p-3 border-b font-mono text-red-600">-en</td></tr>
                                    <tr class="hover:bg-gray-50"><td class="p-3 border-b">ihr</td><td class="p-3 border-b">你們</td><td class="p-3 border-b font-mono text-red-600">-t</td></tr>
                                    <tr class="hover:bg-gray-50"><td class="p-3 border-b">sie/Sie</td><td class="p-3 border-b">他們/您</td><td class="p-3 border-b font-mono text-red-600">-en</td></tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <h3 class="text-xl font-semibold mb-4">動詞變化產生器</h3>
                        <p class="mb-4 text-gray-600">請輸入一個德文原型動詞 (以 -en 結尾)，看看它的現在式變化吧！</p>
                        <div class="flex flex-col sm:flex-row gap-2 mb-4">
                            <input type="text" id="verb-input" class="flex-grow p-2 border rounded-md focus:ring-2 focus:ring-[#BCA37F] focus:border-[#BCA37F] outline-none" placeholder="例如：machen, lernen, spielen">
                            <button id="conjugate-btn" class="px-4 py-2 bg-[#8E7AB5] text-white font-semibold rounded-md hover:bg-[#7c68a0] transition-colors">產生變化</button>
                        </div>
                        <div id="conjugation-result" class="mt-4"></div>
                    </div>

                    <!-- Special Rules -->
                    <div id="special" class="tab-pane hidden">
                        <h3 class="text-xl font-semibold mb-4">1. 詞幹以 <code class="bg-gray-100 text-red-500 px-1 rounded">-s, -ss, -ß, -z, -x</code> 結尾</h3>
                        <p class="mb-4">這類動詞在第二人稱單數 <strong class="text-blue-600">du</strong> 時，因為詞幹本身已有 s 的發音，字尾只需加上 <strong class="font-mono text-red-600">-t</strong>。</p>
                        <p class="p-3 bg-gray-100 rounded-md">例：<strong class="font-semibold">tanzen</strong> (跳舞) → du tan<strong class="text-red-600">zt</strong> (不是 tan<del>zst</del>)</p>
                        
                        <hr class="my-6">

                        <h3 class="text-xl font-semibold mb-4">2. 詞幹以 <code class="bg-gray-100 text-red-500 px-1 rounded">-d, -t</code> 結尾</h3>
                        <p class="mb-4">為了讓發音更順暢，這類動詞在 <strong class="text-blue-600">du</strong>, <strong class="text-blue-600">er/sie/es</strong> 和 <strong class="text-blue-600">ihr</strong> 時，需要在字尾前多加一個 <strong class="font-mono text-red-600">-e-</strong>。</p>
                        <div class="p-3 bg-gray-100 rounded-md">
                           <p>例：<strong class="font-semibold">arbeiten</strong> (工作)</p>
                           <ul class="list-disc list-inside ml-2 mt-2">
                               <li>du arbeit<strong class="text-red-600">est</strong></li>
                               <li>er/sie/es arbeit<strong class="text-red-600">et</strong></li>
                               <li>ihr arbeit<strong class="text-red-600">et</strong></li>
                           </ul>
                        </div>
                    </div>

                    <!-- Irregular Verbs -->
                    <div id="irregular" class="tab-pane hidden">
                        <p class="mb-6 text-center bg-yellow-100 text-yellow-800 p-3 rounded-md">這三個動詞是德文中最常用，但又不遵循上述規則的動詞，你必須特別記住它們的變化！</p>
                        <div class="grid md:grid-cols-3 gap-6">
                            <!-- sein -->
                            <div class="border p-4 rounded-lg">
                                <h4 class="text-lg font-bold text-center mb-2">sein (是/在)</h4>
                                <ul>
                                    <li class="p-2 border-b">ich <strong class="float-right text-blue-600">bin</strong></li>
                                    <li class="p-2 border-b">du <strong class="float-right text-blue-600">bist</strong></li>
                                    <li class="p-2 border-b">er/sie/es <strong class="float-right text-blue-600">ist</strong></li>
                                    <li class="p-2 border-b">wir <strong class="float-right text-blue-600">sind</strong></li>
                                    <li class="p-2 border-b">ihr <strong class="float-right text-blue-600">seid</strong></li>
                                    <li class="p-2">sie/Sie <strong class="float-right text-blue-600">sind</strong></li>
                                </ul>
                            </div>
                             <!-- haben -->
                            <div class="border p-4 rounded-lg">
                                <h4 class="text-lg font-bold text-center mb-2">haben (有)</h4>
                                <ul>
                                    <li class="p-2 border-b">ich <strong class="float-right text-blue-600">habe</strong></li>
                                    <li class="p-2 border-b">du <strong class="float-right text-blue-600">hast</strong></li>
                                    <li class="p-2 border-b">er/sie/es <strong class="float-right text-blue-600">hat</strong></li>
                                    <li class="p-2 border-b">wir <strong class="float-right text-blue-600">haben</strong></li>
                                    <li class="p-2 border-b">ihr <strong class="float-right text-blue-600">habt</strong></li>
                                    <li class="p-2">sie/Sie <strong class="float-right text-blue-600">haben</strong></li>
                                </ul>
                            </div>
                             <!-- werden -->
                            <div class="border p-4 rounded-lg">
                                <h4 class="text-lg font-bold text-center mb-2">werden (變成)</h4>
                                <ul>
                                    <li class="p-2 border-b">ich <strong class="float-right text-blue-600">werde</strong></li>
                                    <li class="p-2 border-b">du <strong class="float-right text-blue-600">wirst</strong></li>
                                    <li class="p-2 border-b">er/sie/es <strong class="float-right text-blue-600">wird</strong></li>
                                    <li class="p-2 border-b">wir <strong class="float-right text-blue-600">werden</strong></li>
                                    <li class="p-2 border-b">ihr <strong class="float-right text-blue-600">werdet</strong></li>
                                    <li class="p-2">sie/Sie <strong class="float-right text-blue-600">werden</strong></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 3: Practice -->
            <section id="practice" class="mb-12">
                <h2 class="text-2xl font-bold mb-4 text-center text-[#8E7AB5]">課後練習</h2>
                <div class="p-6 bg-white rounded-xl shadow-sm">
                    <p class="mb-4 text-gray-600">請試著填入正確的動詞形式，完成這篇小短文。填寫完畢後，點擊按鈕檢查答案！</p>
                    <div id="exercise-text" class="text-lg leading-loose">
                        Hallo, ich <input type="text" data-answer="bin" class="exercise-input"> (sein) Laura. Meine Eltern und ich <input type="text" data-answer="wohnen" class="exercise-input"> (wohnen) in Berlin. Meine Mama <input type="text" data-answer="kocht" class="exercise-input"> (kochen) sehr gern und mein Papa <input type="text" data-answer="isst" class="exercise-input"> (essen) immer viel. Ich <input type="text" data-answer="spreche" class="exercise-input"> (sprechen) gut Deutsch. Was <input type="text" data-answer="sprichst" class="exercise-input"> (sprechen) du als Muttersprache? <input type="text" data-answer="Hast" class="exercise-input"> (Haben) du Geschwister? Was <input type="text" data-answer="unternehmt" class="exercise-input"> (unternehmen) ihr gern am Wochenende?
                    </div>
                    <style>
                        .exercise-input {
                            width: 80px;
                            border: 1px solid #ccc;
                            border-radius: 4px;
                            padding: 2px 4px;
                            text-align: center;
                            margin: 0 4px;
                            transition: all 0.3s;
                        }
                        .exercise-input:focus {
                            outline: none;
                            border-color: #8E7AB5;
                            box-shadow: 0 0 0 2px rgba(142, 122, 181, 0.2);
                        }
                    </style>
                    <div class="mt-6 text-center">
                        <button id="check-answers-btn" class="px-6 py-2 bg-[#BCA37F] text-white font-semibold rounded-md hover:bg-[#a88d6c] transition-colors">檢查答案</button>
                    </div>
                    <div id="answers-feedback" class="mt-4 text-center hidden"></div>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tabs = document.querySelectorAll('.tab-btn');
            const panes = document.querySelectorAll('.tab-pane');

            window.showTab = function(tabName) {
                tabs.forEach(tab => {
                    if (tab.innerText.toLowerCase().includes(tabName)) {
                        tab.classList.remove('tab-inactive');
                        tab.classList.add('tab-active');
                    } else {
                        tab.classList.remove('tab-active');
                        tab.classList.add('tab-inactive');
                    }
                });

                panes.forEach(pane => {
                    if (pane.id === tabName) {
                        pane.classList.remove('hidden');
                    } else {
                        pane.classList.add('hidden');
                    }
                });
            }
            
            const conjugateBtn = document.getElementById('conjugate-btn');
            const verbInput = document.getElementById('verb-input');
            const resultDiv = document.getElementById('conjugation-result');

            // Add irregular verb exceptions here
            const verbExceptions = {
                'essen': {
                    'ich': 'esse',
                    'du': 'isst',
                    'er/sie/es': 'isst',
                    'wir': 'essen',
                    'ihr': 'esst',
                    'sie/Sie': 'essen'
                },
                'fahren': {
                    'ich': 'fahre',
                    'du': 'fährst',
                    'er/sie/es': 'fährt',
                    'wir': 'fahren',
                    'ihr': 'fahrt',
                    'sie/Sie': 'fahren'
                },
                'sprechen': {
                    'ich': 'spreche',
                    'du': 'sprichst',
                    'er/sie/es': 'spricht',
                    'wir': 'sprechen',
                    'ihr': 'sprecht',
                    'sie/Sie': 'sprechen'
                },
                'lesen': {
                    'ich': 'lese',
                    'du': 'liest',
                    'er/sie/es': 'liest',
                    'wir': 'lesen',
                    'ihr': 'lest',
                    'sie/Sie': 'lesen'
                }
            };

            function conjugate() {
                const verb = verbInput.value.trim().toLowerCase();
                if (!verb.endsWith('en') && !verbExceptions.hasOwnProperty(verb)) {
                    resultDiv.innerHTML = `<p class="text-red-500">請輸入以 -en 結尾的動詞或常見不規則動詞 (例如：essen, fahren, sprechen, lesen)。</p>`;
                    return;
                }

                let conjugations = {};
                if (verbExceptions.hasOwnProperty(verb)) {
                    conjugations = verbExceptions[verb];
                } else {
                    const stem = verb.slice(0, -2);
                    const stemEnd = stem.slice(-1);
                    const needsE = ['d', 't'].includes(stemEnd) || 
                                   (['m', 'n'].includes(stemEnd) && !['l', 'r'].includes(stem.slice(-2, -1)));

                    const endings = {
                        'ich': 'e',
                        'du': (['s', 'ß', 'x', 'z'].includes(stemEnd)) ? 't' : (needsE ? 'est' : 'st'),
                        'er/sie/es': needsE ? 'et' : 't',
                        'wir': 'en',
                        'ihr': needsE ? 'et' : 't',
                        'sie/Sie': 'en'
                    };
                    
                    for (const pronoun in endings) {
                        conjugations[pronoun] = stem + endings[pronoun];
                    }
                }

                let html = `<div class="overflow-x-auto"><table class="w-full text-left border-collapse mt-4">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="p-3 font-semibold text-sm border-b">主詞</th>
                                        <th class="p-3 font-semibold text-sm border-b">變化結果</th>
                                    </tr>
                                </thead>
                                <tbody>`;
                
                for (const pronoun in conjugations) {
                    html += `<tr class="hover:bg-gray-50">
                                <td class="p-3 border-b">${pronoun}</td>
                                <td class="p-3 border-b">${conjugations[pronoun]}</td>
                             </tr>`;
                }

                html += `</tbody></table></div>`;
                resultDiv.innerHTML = html;
            }

            conjugateBtn.addEventListener('click', conjugate);
            verbInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    conjugate();
                }
            });
            
            verbInput.value = 'machen';
            conjugate();

            const checkAnswersBtn = document.getElementById('check-answers-btn');
            const exerciseInputs = document.querySelectorAll('.exercise-input');
            const feedbackDiv = document.getElementById('answers-feedback');

            checkAnswersBtn.addEventListener('click', function() {
                let correctCount = 0;
                let totalCount = exerciseInputs.length;
                let showAnswersHTML = '<p class="font-semibold mb-2">正確答案：</p><ul class="list-disc list-inside">';

                exerciseInputs.forEach(input => {
                    const userAnswer = input.value.trim().toLowerCase();
                    const correctAnswer = input.dataset.answer.toLowerCase();
                    
                    input.classList.remove('feedback-correct', 'feedback-incorrect');

                    if (userAnswer === correctAnswer) {
                        input.classList.add('feedback-correct');
                        correctCount++;
                    } else {
                        input.classList.add('feedback-incorrect');
                    }
                    
                    const verbInParentheses = input.nextSibling.textContent.trim();
                    showAnswersHTML += `<li class="text-left ml-4">${verbInParentheses} &rarr; ${correctAnswer}</li>`;
                });
                
                showAnswersHTML += '</ul>';
                feedbackDiv.innerHTML = `<p class="mb-4">你答對了 ${correctCount} / ${totalCount} 題！</p>${showAnswersHTML}`;
                feedbackDiv.classList.remove('hidden');
            });
        });
    </script>

</body>
</html>
